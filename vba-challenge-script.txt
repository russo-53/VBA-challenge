Sub StockData()    Dim ws As Worksheet    Dim select_index As Double    Dim volume As Double        For Each ws In Sheets    Worksheets(ws.Name).Activate            'keep track of the variables in the summery table                Dim Summery_Table_Row As Integer        Summery_Table_Row = 2                Summery_Table = 2                volume = 0                    LastRow = Cells(Rows.Count, 1).End(xlUp).Row               'new columns            Cells(1, 9).Value = "Ticker"            Cells(1, 10).Value = "Yearly Change"            Cells(1, 11).Value = "Percent Change"            Cells(1, 12).Value = "Total Stock Volume"                                   'loop to find Total Volume and Ticker                For i = 2 To LastRow                       If Cells(i + 1, 1).Value <> Cells(i, 1) Then                ticker = Cells(i, 1).Value                volume = volume + Cells(i, 7).Value                                Range("I" & Summery_Table_Row).Value = ticker                Range("L" & Summery_Table_Row).Value = volume                            'add one to the summery table row                Summery_Table_Row = Summery_Table_Row + 1                        'reset the volume                volume = 0                           'if the following ticker is the same            Else            volume = volume + Cells(i, 7).Value                    End If        Next i                           'loop to find first open_date and last close_date                    Summery_Table_Row = 2            For i = 2 To LastRow                If Cells(i, 1).Value <> Cells(i + 1, 1).Value Then                close_date = Cells(i, 6).Value                                ElseIf Cells(i, 1).Value <> Cells(i - 1, 1).Value Then                open_date = Cells(i, 3).Value                End If                If open_date > 0 And close_date > 0 Then                                'find the total change                total_change = close_date - open_date                                'find the percent change                percent_change = total_change / open_date                                Cells(Summery_Table_Row, 11).Value = FormatPercent(percent_change)                Cells(Summery_Table_Row, 10).Value = total_change                                'reset                close_date = 0                open_date = 0                Summery_Table_Row = Summery_Table_Row + 1            End If        Next i                'color accordingly Yearly Change column                For i = 2 To LastRow                    If Cells(i, 10).Value > 0 Then                Cells(i, 10).Interior.ColorIndex = 4            Else                Cells(i, 10).Interior.ColorIndex = 3                            If IsEmpty(Cells(i, 10).Value) Then Exit For            End If        Next i                       'finding greatest values for percentage increase, decrease and volume                            percentage_increase = WorksheetFunction.Max(ActiveSheet.Columns("k"))            percentage_decrease = WorksheetFunction.Min(ActiveSheet.Columns("k"))            greatest_volume = WorksheetFunction.Max(ActiveSheet.Columns("l"))                            Cells(2, 17).Value = FormatPercent(percentage_increase)            Cells(3, 17).Value = FormatPercent(percentage_decrease)            Cells(4, 17).Value = greatest_volume                        Cells(2, 15).Value = "Greatest % Increase"                Cells(3, 15).Value = "Greatest % Decrease"                Cells(4, 15).Value = "Greatest Total Volume"                Cells(1, 16).Value = "Ticker"                Cells(1, 17).Value = "Value"        For i = 2 To LastRow                    If percentage_increase = Cells(i, 11).Value Then                Cells(2, 16).Value = Cells(i, 9).Value                            ElseIf percentage_decrease = Cells(i, 11).Value Then                Cells(3, 16).Value = Cells(i, 9).Value                            ElseIf greatest_volume = Cells(i, 12).Value Then                Cells(4, 16).Value = Cells(i, 9).Value            End If                    Next i                 Next ws                    End Sub